<html>
	<head>
		<title>
			Scale-Perf
		</title>
		
		<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
		<meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no, width=100%" />
		
		<style>
			body {
				background:		#ddd;
			}
			
			h1 {
				margin-top:		30px;
				margin-bottom:	30px;
			}
			
			#Main {
				background:		#fff;
				border-radius:	5px;
				padding:		5px;
				box-shadow:		0px 0px 5px #000;
			}

			#LinkRow {
				text-align:	right;
			}
			
			@media (min-width: 980px) {
				.full_row {
					width:			980px;
					margin-left:	auto;
					margin-right:	auto;
				}
			}
			
			#MobileInstruction > li { list-style-type: none; }
			#MobileInstruction:not(.s1) > li.s1 { display: none; }
			#MobileInstruction:not(.s2) > li.s2 { display: none; }
			#MobileInstruction:not(.s3) > li.s3 { display: none; }
		</style>
	</head>
	<body>
		<div class="container">
			<h1 class="full_row">SCALE performance bookmarklet</h1>
			
			<div id="Main" class="row full_row">
				<h2>Desktop</h2>
				<div>
					Drag and drop this intop your link bar: <a id="DesktopLink">Scale-Perf</a>
				</div>
				
				<h2>Mobile</h2>
				
				<ol id="MobileInstruction" class="s1">
					<li class="s1">1. Click this link: <a id="MobileLink" onclick="changeToStep(2)">SCALE Perf bookmarklet</a></li>
					<li class="s2">
						2. Bookmark this page<br />
						<button class="btn" onclick="changeToStep(3)">ok, did it!</button>
					</li>
					<li class="s3">3.
						Edit the bookmark URL and remove everything up to and including the hash ("#")
						so that the bookmark URL starts with "javascript:"
						<br />
						Example:
						<br />
						<img class="img-responsive" src="images/mobileAddBokkmarkletExample.png" />
					</li>
				</ol>
			</div>
			
			<div id="LinkRow" class="full_row row"></div>
		</div>
		
		<script>
			(function(){
				var main = document.getElementById("Main");
				
				function scriptLoadFunction(scriptPath){
					var isLocal = ((self.location+"").split("http://").pop().split("/")[0] == "localhost");
					
					if(scriptPath == null)
					{
						scriptPath = (isLocal ?
							"http://localhost/perf-bookmarklet.js"
							: "https://scale-team.github.io/scale-perf/perf-bookmarklet.js");
					}
					
					var body = document.getElementsByTagName("body")[0];
					
					var loadingElem = document.createElement("div");
					loadingElem.id = "ScalePerfLoadingHint";
					loadingElem.innerHTML = "loading scale performance tests...";
					loadingElem.style.cssText = "color:#fff;position:absolute;top:0;left:0;background-color:#000;padding:5;box-shadow:0 0 5px #000;";
					
					var jselem = document.createElement("script");
					jselem.type = "text/javascript";
					jselem.src = scriptPath;
					jselem.onload = function() {
						body.removeChild(loadingElem);
					};
					
					body.appendChild(loadingElem).appendChild(jselem);
				};
				
				var linkElem = document.getElementById("DesktopLink");
				linkElem.href = 'javascript:' + scriptLoadFunction + '; scriptLoadFunction();';
				linkElem.href = linkElem.href.replace(new RegExp("\n", 'g'), "");
				document.getElementById("MobileLink").href = "#" + linkElem.href;
				
				(function() {
					/*Get GET-parameters*/ {
						var _GET = {};
						var parts = location.href.split("?");
						
						if(parts.length > 1)
						{
							parts = parts.pop().split("&");
							
							for(var f in parts)
							{
								var p = parts[f].split("=");
								
								_GET[p[0]] = (p.length > 1 ? p[1] : true);
							}
						}
					}
					
					// If developer set, modify bookmarklet URL
					if(_GET["developer"] != null)
					{
						linkElem.href = 'javascript:var isDevelopmentMode=true; ' + scriptLoadFunction + '; scriptLoadFunction("https://scale-team.github.io/scale-perf-dev/perf-bookmarklet.js");';
						linkElem.href = linkElem.href.replace(new RegExp("\n", 'g'), "");
						linkElem.innerHTML += " DEV";
					}
					
					var linkRow = document.getElementById("LinkRow");
					var devLink = document.createElement("a");
					linkRow.appendChild(devLink);
					
					if(_GET["developer"] == null)
					{
						devLink.href = "index.html?developer";
						devLink.innerHTML = "Developer";
					}
					else
					{
						devLink.href = "index.html";
						devLink.innerHTML = "Normal";
					}
				})();
			})();
			
			function changeToStep(nr){
				document.getElementById("MobileInstruction").className = "s" + nr;
			}
		</script>
	</body>
</html>