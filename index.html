<html>
	<head>
		<title>
			Scale-Perf
		</title>
		
		<style>
			body {
				font-family:	Arial;
				color:			#444;
				background:		#ddd;
			}
			
			h1 {
				color:			#999;
				width:			980px;
				margin:			30px auto;
				text-shadow:	1px 1px 2px #fff, -1px -1px 2px #000;
			}
			
			#Main {
				width:			980px;
				background:		#fff;
				border-radius:	5px;
				padding:		5px;
				margin:			0px auto;
				box-shadow:		0px 0px 5px;
			}
		</style>
	</head>
	<body>
		<h1>SCALE performance bookmarklet</h1>
		
		<div id="Main"></div>
		
		<script>
			var main = document.getElementById("Main");
			
			function scriptLoadFunction(scriptPath){
				if(document.getElementById("PerfBar") != null) return;
				
				var main = document.getElementsByTagName("body")[0];
				
				var loadingElem = document.createElement("div");
				loadingElem.innerText = "loading scale performance tests...";
				loadingElem.style.color = "#fff";
				loadingElem.style.position = "absolute";
				loadingElem.style.top = 0;
				loadingElem.style.left = 0;
				loadingElem.style.backgroundColor = "#000";
				loadingElem.style.padding = 5;
				loadingElem.style.boxShadow = "0 0 5px #000";
				main.appendChild(loadingElem);
				
				var jselem = document.createElement("script");
				jselem.type = "text/javascript";
				jselem.src = scriptPath + "?" + (Math.round(Math.random() * Math.pow(2, 16)));
				jselem.onload = function() {
					main.removeChild(loadingElem);
				};
				main.appendChild(jselem);
				
				console.log("Load SCALE performance bar from " + jselem.src);
			};
			
			var links = [
				{
					title:	"Script hosted on Github",
					script:	"https://rawgit.com/scale-team/scale-perf/master/perf-bookmarklet.js",
					text:	"Scale-Perf"
				}
			];
			
			var isLocal = ((self.location+"").split("http://").pop().split("/")[0] == "localhost");
			if(isLocal)
			{
				links.push({
					title:	"Lokale Variante",
					script:	"http://localhost/perf-bookmarklet.js",
					text:	"Loc-Scale-Perf"
				});
			}
			
			for(var f in links)
			{
				var link = links[f];
				
				var div = document.createElement("div");
				
					var title = document.createElement("h2");
					title.innerText = link.title;
					div.appendChild(title);
					
					var desktop = document.createElement("h3");
					desktop.innerText = "Desktop";
					div.appendChild(desktop);
					
					var description = document.createElement("div");
					description.innerText = "Drag and drop this intop your link bar: ";
					div.appendChild(description);
					
					var linkElem = document.createElement("a");
					linkElem.text = link.text;
					linkElem.href = 'javascript:' + scriptLoadFunction + '; scriptLoadFunction("' + link.script + '")';
					description.appendChild(linkElem);
					
					var mobile = document.createElement("h2");
					mobile.innerText = "Mobile";
					div.appendChild(mobile);
					
					var mobileText = document.createElement("ol");
						var step = document.createElement("li");
						step.innerText = "click this link: ";
							var mobileLink = document.createElement("a");
							mobileLink.innerText = "SCALE Perf bookmarklet";
							mobileLink.href = "#" + linkElem.href;
							step.appendChild(mobileLink);
						
						mobileText.appendChild(step);
						step = document.createElement("li");
						step.innerText = "bookmark this page";
						mobileText.appendChild(step);
						var step = document.createElement("li");
						step.innerText = 'edit the bookmark URL and remove everything up to and including the hash ("#") so that the bookmark URL starts with "javascript:"';;
						mobileText.appendChild(step);
					
					div.appendChild(mobileText);
					
				main.appendChild(div);
			}
		</script>
	</body>
</html>