<html>
	<head>
		<title>
			Scale-Perf
		</title>
		
		<style>
			body {
				font-family:	Arial;
				color:			#444;
				background:		#ddd;
			}
			
			h1 {
				color:			#999;
				width:			980px;
				margin:			30px auto;
				text-shadow:	1px 1px 2px #fff, -1px -1px 2px #000;
			}
			
			#Main {
				width:			980px;
				background:		#fff;
				border-radius:	5px;
				padding:		5px;
				margin:			0px auto;
				box-shadow:		0px 0px 5px;
			}
		</style>
	</head>
	<body>
		<h1>SCALE performance bookmarklet</h1>
		
		<div id="Main">
			<h2>Script hosted on Github</h2>
			
			<h3>Desktop</h3>
			<div>
				Drag and drop this intop your link bar: <a id="desktopLink">Scale-Perf</a>
			</div>
			
			<h2>Mobile</h2>
			
			<ol>
				<li>Click this link: <a id="mobileLink">SCALE Perf bookmarklet</a></li>
				<li>Bookmark this page</li>
				<li>
					Edit the bookmark URL and remove everything up to and including the hash ("#")
					so that the bookmark URL starts with "javascript:"
				</li>
			</ol>
		</div>
		
		<script>
			var main = document.getElementById("Main");
			
			function scriptLoadFunction(){
				var perfBar = document.getElementById("PerfBar");
				if(perfBar != null)
				{
					perfBar.style.display = "block";
					return;
				}
				
				var isLocal = ((self.location+"").split("http://").pop().split("/")[0] == "localhost");
				var scriptPath = (isLocal ?
					"http://localhost/perf-bookmarklet.js"
					: "https://rawgit.com/scale-team/scale-perf/master/perf-bookmarklet.js");
				
				var main = document.getElementsByTagName("body")[0];
				
				var loadingElem = document.createElement("div");
				loadingElem.innerText = "loading scale performance tests...";
				loadingElem.style.color = "#fff";
				loadingElem.style.position = "absolute";
				loadingElem.style.top = 0;
				loadingElem.style.left = 0;
				loadingElem.style.backgroundColor = "#000";
				loadingElem.style.padding = 5;
				loadingElem.style.boxShadow = "0 0 5px #000";
				main.appendChild(loadingElem);
				
				var jselem = document.createElement("script");
				jselem.type = "text/javascript";
				jselem.src = scriptPath + "?" + (Math.round(Math.random() * Math.pow(2, 16)));
				jselem.onload = function() {
					main.removeChild(loadingElem);
				};
				main.appendChild(jselem);
				
				console.log("Load SCALE performance bar from " + jselem.src);
			};
			
			var linkElem = document.getElementById("desktopLink");
			linkElem.href = 'javascript:' + scriptLoadFunction + '; scriptLoadFunction()';
			document.getElementById("mobileLink").href = "#" + linkElem.href;
		</script>
	</body>
</html>