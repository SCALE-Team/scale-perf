<html>
	<head>
		<title>
			Scale-Perf
		</title>
		
	</head>
	<body>
		<script>
			var body = document.getElementsByTagName("body")[0];
			
			function scriptLoadFunction(scriptPath){
				var body = document.getElementsByTagName("body")[0];
				
				var loadingElem = document.createElement("div");
				loadingElem.innerText = "loading scale performance tests...";
				loadingElem.style.color = "#fff";
				loadingElem.style.position = "absolute";
				loadingElem.style.top = 0;
				loadingElem.style.left = 0;
				loadingElem.style.backgroundColor = "#000";
				loadingElem.style.padding=5;
				loadingElem.style.boxShadow = "0 0 5px #000";
				body.appendChild(loadingElem);
				
				var jselem = document.createElement("script");
				jselem.type = "text/javascript";
				jselem.src = scriptPath + "?" + (Math.round(Math.random() * Math.pow(2, 16)));
				jselem.onload = function() {
					body.removeChild(loadingElem);
				};
				body.appendChild(jselem);
				
				console.log("Load SCALE performance bar from " + jselem.src);
			};
			
			var links = [
				{
					title:	"Zieh das in deine Link Leiste",
					script:	"https://rawgit.com/scale-team/scale-perf/master/perf-bookmarklet.js",
					text:	"Scale-Perf"
				}
			];
			
			var isLocal = ((self.location+"").split("http://").pop().split("/")[0] == "localhost");
			if(isLocal)
			{
				links.push({
					title:	"Lokale Variante",
					script:	"http://localhost/perf-bookmarklet.js",
					text:	"Loc-Scale-Perf"
				});
			}
			
			for(var f in links)
			{
				var link = links[f];
				
				var div = document.createElement("div");
				
					var title = document.createElement("h1");
					title.innerText = link.title + ":";
					div.appendChild(title);
					
					var desktop = document.createElement("h2");
					desktop.innerText = "DESKTOP";
					div.appendChild(desktop);
					
					var linkElem = document.createElement("a");
					linkElem.text = link.text;
					linkElem.href = 'javascript:' + scriptLoadFunction + '; scriptLoadFunction("' + link.script + '")';
					div.appendChild(linkElem);
					
					var mobile = document.createElement("h2");
					mobile.innerText = "MOBILE";
					div.appendChild(mobile);
					
					var mobileText = document.createElement("ol");
						var step = document.createElement("li");
						step.innerText = "click this link: ";
							var mobileLink = document.createElement("a");
							mobileLink.innerText = "SCALE Perf bookmarklet";
							mobileLink.href = "#" + linkElem.href;
							step.appendChild(mobileLink);
						
						mobileText.appendChild(step);
						step = document.createElement("li");
						step.innerText = "bookmark this page";
						mobileText.appendChild(step);
						var step = document.createElement("li");
						step.innerText = 'edit the bookmark URL and remove everything up to and including the hash ("#") so that the bookmark URL starts with "javascript:"';;
						mobileText.appendChild(step);
					
					div.appendChild(mobileText);
					
				body.appendChild(div);
			}
		</script>
	</body>
</html>